<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Interactive Random Pattern Quiz</title>
<style>
.options { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
.option-container { 
  position: relative; 
  width: 350px; 
  height: 350px; 
  cursor: pointer; 
  border: 1px solid #ccc;
}
.option-container iframe { width: 100%; height: 100%; pointer-events: none; }
.feedback { 
  position: absolute; top: 5px; left: 5px; font-weight: bold; 
  color: white; background: rgba(0,0,0,0.6); padding: 2px 5px; 
  border-radius: 3px; display: none; 
}
.overlay { 
  position: absolute; top:0; left:0; width:100%; height:100%; 
  background: transparent; 
}
#target iframe { width: 300px; height: 300px; border: 1px solid #ccc; }
</style>
</head>
<body>

<h2>Match this pattern:</h2>
<div id="target"></div>

<h3>Choices:</h3>
<div class="options" id="choices"></div>

<script>
// Helper functions
function rand(min,max){ return (Math.random()*(max-min)+min).toFixed(2); }
function randomPattern(){ return {theta:rand(0,6.28), phi:rand(0,3.14), z:rand(-1,1)}; }
function patternFrame(p){ 
  return `<iframe src="https://stevenbm.github.io/Testwebbasedgeneration/sites/Image_gen.html?theta=${p.theta}&phi=${p.phi}&z=${p.z}"></iframe>`; 
}

// 1️⃣ Generate target
let targetPattern = randomPattern();
document.getElementById("target").innerHTML = patternFrame(targetPattern);

// 2️⃣ Generate distractors
let distractors = [randomPattern(), randomPattern(), randomPattern()];

// 3️⃣ Randomize correct option
let correctIndex = Math.floor(Math.random()*4);
let optionsHTML = [];

for(let i=0;i<4;i++){
  let isCorrect = (i === correctIndex);
  let pattern = isCorrect ? targetPattern : distractors.pop();
  optionsHTML.push(`
    <div class="option-container" data-correct="${isCorrect}">
      ${patternFrame(pattern)}
      <div class="overlay"></div>
      <div class="feedback"></div>
    </div>
  `);
}

// 4️⃣ Insert options
document.getElementById("choices").innerHTML = optionsHTML.join("");

// 5️⃣ Attach click handlers to overlay
document.querySelectorAll('.option-container').forEach(container => {
  let overlay = container.querySelector('.overlay');
  overlay.addEventListener('click', () => {
    let feedback = container.querySelector('.feedback');
    if(container.dataset.correct === "true"){
      feedback.textContent = "✅ Correct!";
      feedback.style.background = "green";
    } else {
      feedback.textContent = "❌ Try Again!";
      feedback.style.background = "red";
    }
    feedback.style.display = "block";
  });
});
</script>

</body>
</html>